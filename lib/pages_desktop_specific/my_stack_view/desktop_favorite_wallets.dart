/* 
 * This file is part of Stack Wallet.
 * 
 * Copyright (c) 2023 Cypher Stack
 * All Rights Reserved.
 * The code is distributed under GPLv3 license, see LICENSE file for details.
 * Generated by Cypher Stack on 2023-05-26
 *
 */

import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:flutter_svg/svg.dart';

import '../../pages/manage_favorites_view/manage_favorites_view.dart';
import '../../pages/wallets_view/sub_widgets/favorite_card.dart';
import '../../themes/stack_colors.dart';
import '../../utilities/assets.dart';
import '../../utilities/constants.dart';
import '../../utilities/text_styles.dart';
import '../../wallets/isar/providers/favourite_wallets_provider.dart';
import '../../widgets/custom_buttons/blue_text_button.dart';

class DesktopFavoriteWallets extends ConsumerWidget {
  const DesktopFavoriteWallets({super.key});

  static const cardWidth = 220.0;
  static const cardHeight = 125.0;
  static const standardPadding = 16.0;

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    debugPrint("BUILD: $runtimeType");
    final favourites = ref.watch(pFavouriteWalletInfos(true));

    final bool hasFavorites = favourites.isNotEmpty;
    return Column(
      mainAxisSize: MainAxisSize.min,
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        Row(
          mainAxisAlignment: MainAxisAlignment.spaceBetween,
          children: [
            Text(
              "Favorite wallets",
              style: STextStyles.desktopTextExtraSmall(context).copyWith(
                color: Theme.of(context)
                    .extension<StackColors>()!
                    .textFieldActiveSearchIconRight,
              ),
            ),
            CustomTextButton(
              text: "Edit",
              onTap: () {
                Navigator.of(context).pushNamed(ManageFavoritesView.routeName);
              },
            ),
          ],
        ),
        const SizedBox(
          height: 20,
        ),
        ConstrainedBox(
          constraints: const BoxConstraints(
            maxHeight: (cardHeight * 2) + standardPadding,
            minHeight: cardHeight,
          ),
          child: hasFavorites
              ? SingleChildScrollView(
                  primary: false,
                  child: Wrap(
                    spacing: 16,
                    runSpacing: 16,
                    children: [
                      ...favourites.map((e) {
                        return FavoriteCard(
                          walletId: e.walletId,
                          key: Key(e.name),
                          width: cardWidth,
                          height: cardHeight,
                        );
                      }),
                    ],
                  ),
                )
              : Container(
                  height: cardHeight,
                  width: cardWidth,
                  decoration: BoxDecoration(
                    color: Theme.of(context)
                        .extension<StackColors>()!
                        .textFieldDefaultBG,
                    borderRadius: BorderRadius.circular(
                      Constants.size.circularBorderRadius,
                    ),
                  ),
                  child: MaterialButton(
                    splashColor:
                        Theme.of(context).extension<StackColors>()!.highlight,
                    key: const Key("favoriteWalletsAddFavoriteButtonKey"),
                    padding: const EdgeInsets.all(12),
                    materialTapTargetSize: MaterialTapTargetSize.shrinkWrap,
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(
                        Constants.size.circularBorderRadius,
                      ),
                    ),
                    onPressed: () {
                      Navigator.of(context)
                          .pushNamed(ManageFavoritesView.routeName);
                    },
                    child: Row(
                      mainAxisAlignment: MainAxisAlignment.center,
                      children: [
                        SvgPicture.asset(
                          Assets.svg.plus,
                          width: 14,
                          height: 14,
                          color: Theme.of(context)
                              .extension<StackColors>()!
                              .textSubtitle1,
                        ),
                        const SizedBox(
                          width: 4,
                        ),
                        Text(
                          "Add a favorite",
                          style: STextStyles.itemSubtitle(context).copyWith(
                            fontSize: 18,
                          ),
                        ),
                      ],
                    ),
                  ),
                ),
        ),
        const SizedBox(
          height: 40,
        ),
      ],
    );
  }
}
